#!/bin/bash

echo removing
python remove.py -f months/201404.txt -o data_historic/data_historic.csv.removed -c \
    Master_Fvencimiento \
    Master_Finiciomora \
    Master_fultimo_cierre \
    Master_fechaalta \
    Visa_Fvencimiento \
    Visa_Finiciomora \
    Visa_fultimo_cierre \
    Visa_fechaalta 

echo 'joining historic'
python join_select.py -m data_historic/data_historic.csv.removed -l \
    historic.bak/201404/201404_cautoservicio_transacciones  \
    historic.bak/201404/201404_ccajeros_ajenos_transacciones \
    historic.bak/201404/201404_ccajeros_propios_descuentos \
    historic.bak/201404/201404_ccajeros_propio_transacciones \
    historic.bak/201404/201404_ccallcenter_transacciones \
    historic.bak/201404/201404_ccambio_monedas_compra \
    historic.bak/201404/201404_ccambio_monedas_venta \
    historic.bak/201404/201404_ccheques_depositados \
    historic.bak/201404/201404_ccheques_depositados_rechazados \
    historic.bak/201404/201404_ccheques_emitidos \
    historic.bak/201404/201404_ccheques_emitidos_rechazados \
    historic.bak/201404/201404_ccomisiones_mantenimiento \
    historic.bak/201404/201404_ccomisiones_otras \
    historic.bak/201404/201404_ccuenta_descuentos \
    historic.bak/201404/201404_cextraccion_autoservicio \
    historic.bak/201404/201404_chomebanking_transacciones \
    historic.bak/201404/201404_cliente_sucursal \
    historic.bak/201404/201404_cliente_vip \
    historic.bak/201404/201404_cplan_sueldo_transaccion \
    historic.bak/201404/201404_cprestamos_hipotecarios \
    historic.bak/201404/201404_cprestamos_personales \
    historic.bak/201404/201404_cprestamos_prendarios \
    historic.bak/201404/201404_ctarjeta_debito_transacciones \
    historic.bak/201404/201404_ctarjeta_master_descuentos \
    historic.bak/201404/201404_ctarjeta_master_transacciones \
    historic.bak/201404/201404_ctarjeta_visa_descuentos \
    historic.bak/201404/201404_ctarjeta_visa_transacciones \
    historic.bak/201404/201404_ctransferencias_emitidas \
    historic.bak/201404/201404_ctransferencias_recibidas \
    historic.bak/201404/201404_mactivos_margen \
    historic.bak/201404/201404_marketing_activo_ultimos90dias \
    historic.bak/201404/201404_marketing_coss_selling \
    historic.bak/201404/201404_Master_cuenta_estado \
    historic.bak/201404/201404_Master_madelantodolares \
    historic.bak/201404/201404_Master_madelantopesos \
    historic.bak/201404/201404_Master_marca_atraso \
    historic.bak/201404/201404_Master_mconsumosdolares \
    historic.bak/201404/201404_Master_mconsumospesos \
    historic.bak/201404/201404_Master_mconsumototal \
    historic.bak/201404/201404_Master_mfinanciacion_limite \
    historic.bak/201404/201404_Master_mlimitecompra \
    historic.bak/201404/201404_Master_mpagado \
    historic.bak/201404/201404_Master_mpagominimo \
    historic.bak/201404/201404_Master_mpagosdolares \
    historic.bak/201404/201404_Master_mpagospesos \
    historic.bak/201404/201404_Master_msaldodolares \
    historic.bak/201404/201404_Master_msaldopesos \
    historic.bak/201404/201404_Master_msaldototal \
    historic.bak/201404/201404_Master_tadelantosefectivo \
    historic.bak/201404/201404_Master_tconsumos \
    historic.bak/201404/201404_mautoservicio \
    historic.bak/201404/201404_mbonos_gobierno \
    historic.bak/201404/201404_mcaja_ahorro_dolares \
    historic.bak/201404/201404_mcaja_ahorro_Nopaquete \
    historic.bak/201404/201404_mcaja_ahorro_Paquete \
    historic.bak/201404/201404_mcajeros_ajenos \
    historic.bak/201404/201404_mcajeros_propio \
    historic.bak/201404/201404_mcajeros_propios_descuentos \
    historic.bak/201404/201404_mcambio_monedas_compra \
    historic.bak/201404/201404_mcambio_monedas_venta \
    historic.bak/201404/201404_mcheques_depositados \
    historic.bak/201404/201404_mcheques_depositados_rechazados \
    historic.bak/201404/201404_mcheques_emitidos \
    historic.bak/201404/201404_mcheques_emitidos_rechazados \
    historic.bak/201404/201404_mcomisiones \
    historic.bak/201404/201404_mcomisiones_mantenimiento \
    historic.bak/201404/201404_mcomisiones_otras \
    historic.bak/201404/201404_mcuenta_corriente_dolares \
    historic.bak/201404/201404_mcuenta_corriente_Nopaquete \
    historic.bak/201404/201404_mcuenta_corriente_Paquete \
    historic.bak/201404/201404_mcuenta_debitos_automaticos \
    historic.bak/201404/201404_mcuenta_descuentos \
    historic.bak/201404/201404_mcuentas_saldo \
    historic.bak/201404/201404_mdescubierto_preacordado \
    historic.bak/201404/201404_mextraccion_autoservicio \
    historic.bak/201404/201404_mfondos_comunes_inversion_dolares \
    historic.bak/201404/201404_mfondos_comunes_inversion_pesos \
    historic.bak/201404/201404_minversiones_otras \
    historic.bak/201404/201404_mmonedas_extranjeras \
    historic.bak/201404/201404_mpagodeservicios \
    historic.bak/201404/201404_mpagomiscuentas \
    historic.bak/201404/201404_mpasivos_margen \
    historic.bak/201404/201404_mplan_sueldo \
    historic.bak/201404/201404_mplan_sueldo_manual \
    historic.bak/201404/201404_mplazo_fijo_dolares \
    historic.bak/201404/201404_mplazo_fijo_pesos \
    historic.bak/201404/201404_mprestamos_hipotecarios \
    historic.bak/201404/201404_mprestamos_personales \
    historic.bak/201404/201404_mprestamos_prendarios \
    historic.bak/201404/201404_mrentabilidad \
    historic.bak/201404/201404_mrentabilidad_annual \
    historic.bak/201404/201404_mtarjeta_master_consumo \
    historic.bak/201404/201404_mtarjeta_master_descuentos \
    historic.bak/201404/201404_mtarjeta_visa_consumo \
    historic.bak/201404/201404_mtarjeta_visa_descuentos \
    historic.bak/201404/201404_mtitulos \
    historic.bak/201404/201404_mtransferencias_emitidas \
    historic.bak/201404/201404_mtransferencias_recibidas \
    historic.bak/201404/201404_mttarjeta_master_debitos_automaticos \
    historic.bak/201404/201404_mttarjeta_visa_debitos_automaticos \
    historic.bak/201404/201404_participa \
    historic.bak/201404/201404_tautoservicio \
    historic.bak/201404/201404_tcaja_ahorro \
    historic.bak/201404/201404_tcajas \
    historic.bak/201404/201404_tcajas_consultas \
    historic.bak/201404/201404_tcajas_depositos \
    historic.bak/201404/201404_tcaja_seguridad \
    historic.bak/201404/201404_tcajas_extracciones \
    historic.bak/201404/201404_tcajas_otras \
    historic.bak/201404/201404_tcallcenter \
    historic.bak/201404/201404_tcambio_monedas \
    historic.bak/201404/201404_tcuenta_corriente \
    historic.bak/201404/201404_tcuenta_debitos_automaticos \
    historic.bak/201404/201404_tcuentas \
    historic.bak/201404/201404_tfondos_comunes_inversion \
    historic.bak/201404/201404_thomebanking \
    historic.bak/201404/201404_tmovimientos_ultimos90dias \
    historic.bak/201404/201404_tpagodeservicios \
    historic.bak/201404/201404_tpagomiscuentas \
    historic.bak/201404/201404_tpaquete1 \
    historic.bak/201404/201404_tpaquete2 \
    historic.bak/201404/201404_tpaquete3 \
    historic.bak/201404/201404_tpaquete4 \
    historic.bak/201404/201404_tpaquete5 \
    historic.bak/201404/201404_tpaquete6 \
    historic.bak/201404/201404_tpaquete7 \
    historic.bak/201404/201404_tpaquete8 \
    historic.bak/201404/201404_tpaquete9 \
    historic.bak/201404/201404_tplan_sueldo \
    historic.bak/201404/201404_tplazo_fijo \
    historic.bak/201404/201404_tseguro_accidentes_personales \
    historic.bak/201404/201404_tseguro_auto \
    historic.bak/201404/201404_tseguro_vida_mercado_abierto \
    historic.bak/201404/201404_tseguro_vivienda \
    historic.bak/201404/201404_ttarjeta_debito \
    historic.bak/201404/201404_ttarjeta_master \
    historic.bak/201404/201404_ttarjeta_master_debitos_automaticos \
    historic.bak/201404/201404_ttarjeta_visa \
    historic.bak/201404/201404_ttarjeta_visa_debitos_automaticos \
    historic.bak/201404/201404_ttitulos \
    historic.bak/201404/201404_Visa_cuenta_estado \
    historic.bak/201404/201404_Visa_madelantodolares \
    historic.bak/201404/201404_Visa_madelantopesos \
    historic.bak/201404/201404_Visa_marca_atraso \
    historic.bak/201404/201404_Visa_mconsumosdolares \
    historic.bak/201404/201404_Visa_mconsumospesos \
    historic.bak/201404/201404_Visa_mconsumototal \
    historic.bak/201404/201404_Visa_mfinanciacion_limite \
    historic.bak/201404/201404_Visa_mlimitecompra \
    historic.bak/201404/201404_Visa_mpagado \
    historic.bak/201404/201404_Visa_mpagominimo \
    historic.bak/201404/201404_Visa_mpagosdolares \
    historic.bak/201404/201404_Visa_mpagospesos \
    historic.bak/201404/201404_Visa_msaldodolares \
    historic.bak/201404/201404_Visa_msaldopesos \
    historic.bak/201404/201404_Visa_msaldototal \
    historic.bak/201404/201404_Visa_tadelantosefectivo \
    historic.bak/201404/201404_Visa_tconsumos \
 -c 0 1 2 3 4 > data_historic/data_historic.csv


echo 'cleaning'
python clean.py -f data_historic/data_historic.csv -o data_historic/data_historic.csv.clean

